# Recipe Standard (draft)

## What is recipe

recipe is an instruction about how to construct a new dataset from existing one.
by reading and running the recipe executor, one can generate a new dataset based
on the `ingredients` and `procedures` described in the recipe.

## structure of for a recipe

A recipe is made of following parts:

- basic info
- configuration
- includes
- cooking procedures

A recipe file can be in either json or yaml format. Check
[recipe_unpop.yaml](https://github.com/semio/ddf--gapminder--systema_globalis/blob/feature/autogenerated/etl/recipes/recipe_unpop.yaml) for a example.

### basic info

all basic info are stored in `info` section of the recipe. an `id` field is
required inside this section. Any other information about the new dataset can be
store inside this section, such as `name`, `provider`, `description` and so on.

### config

inside configuration section. we define the configuration of dirs. currently we
can set below path:

- `ddf_dir`: the directory that contains all ddf csv repos. Must set this
variable in the main recipe.
- `recipes_dir`: the directory contains all recipes to include. Must set this 
variable if we have `include` section.
- `dictionary_dir`: the directory contains all translation files. Must set this
variable if we have json file in the options of procedures. (translation
will be discussed later)

### include

one recipe can include other recipes inside itself. to include a recipe, simply
append the filename to the `include` section. note that it should be a absolute
path or a filename inside the `recipes_dir`.

### cooking procedures

`cooking` section is a dictionary contains one or more list of procedures to
build a dataset. valid keys for cooking section are _datapoints_, _entities_,
_concepts_.

supported procedures currently:

- translate_header
    - translate the headers of the datapoints
- translate_column
    - translate the values in a column
- identity
    - identity function = nothing changes
- merge
    - merge ingredients together on the keys
- align
    - align two columns in two ingredients
    - discussion: https://github.com/semio/ddf_utils/issues/3
- groupby
    - group ingredient data by keys
    - discussion: https://github.com/semio/ddf_utils/issues/4
- filter_row
    - filter ingredient data by values
    - discussion: https://github.com/semio/ddf_utils/issues/2
- filter_item
    - filter ingredient data by concepts
    - discussion: https://github.com/semio/ddf_utils/issues/14
- run_op
    - run math operations on ingredient
    - discussion: https://github.com/semio/ddf_utils/issues/7
