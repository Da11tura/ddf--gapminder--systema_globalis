info:
  id: sg-gapminder-vip-dataset
include:
- recipe_gw_common.yaml
config:
  external_csv_dir: ../external_csv
  procedure_dir: ./procedure
  dictionary_dir: ../translation_dictionaries
  recipes_dir: ./
ingredients:
- dataset: open-numbers/ddf--gapminder--suicide_homicide_traffic_death_rates
  value:
  - death_rate_all_age
  key: sex, cause, country, year
  id: vip-datapoints-all-ages
- dataset: open-numbers/ddf--gapminder--suicide_homicide_traffic_death_rates
  value:
  - death_rate_0_14
  - death_rate_15_29
  - death_rate_30_44
  - death_rate_45_59
  - death_rate_60plus
  key: sex, cause, country, year
  id: vip-datapoints-age-spec
cooking:
  datapoints:
  - ingredients:
    - vip-datapoints-all-ages
    result: vip-datapoints-all-ages-flattened
    procedure: flatten
    options:
      skip_totals_among_entities: []
      flatten_dimensions:
      - cause
      - sex
      dictionary:
        '*': ! '{cause}_{sex}_{concept}'
  - ingredients:
    - vip-datapoints-all-ages-flattened
    result: vip-datapoints-all-ages-final
    procedure: translate_header
    options:
      duplicated: error
      dictionary: indicators_gm_vip_sg.json
  - ingredients:
    - vip-datapoints-age-spec
    result: vip-datapoints-age-spec-filtered
    procedure: filter
    options:
      row:
        sex:
        - '0'
      item: {}
  - ingredients:
    - vip-datapoints-age-spec-filtered
    result: vip-datapoints-age-spec-flattened
    procedure: flatten
    options:
      skip_totals_among_entities: []
      flatten_dimensions:
      - cause
      - sex
      dictionary:
        '*': ! '{cause}_{concept}'
  - ingredients:
    - vip-datapoints-age-spec-flattened
    result: vip-datapoints-age-spec-final
    procedure: translate_header
    options:
      duplicated: error
      dictionary: indicators_gm_vip_sg.json
  - ingredients:
    - vip-datapoints-all-ages-final
    - vip-datapoints-age-spec-final
    result: vip-datapoints-final
    procedure: merge
    options:
      deep: false
  # - procedure: serve
  #   ingredients:
  #       - vip-datapoints-final
  #   options:
  #       digits: 4
