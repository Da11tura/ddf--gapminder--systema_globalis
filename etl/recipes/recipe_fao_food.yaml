# recipe for fao food_supply dataset
info:
    id: sg-fao_food-dataset
    base:
        - &d1 open-numbers/ddf--unfao--faostat

config:
    # the path to search recipe files to include
    recipes_dir: ./
    # the path to search dictionary files
    dictionary_dir: ../translation_dictionaries


# define your ingredients and procedures below
ingredients:
    - id: fao_food-datapoints
      dataset: *d1
      key: "geo,year"
      value:
          - forest_share_in_land_area_ele1
          - forest_area_ile
          - planted_forest_area_ile
          - primary_forest_area_ile
          - sugar_sweeteners_food_supply_quantity_g_capita_day_fce
          - grand_total_food_supply_kcal_capita_day_fea

    - id: fao_food-countries
      dataset: *d1
      key: geo
      value: "*"

include:
    - recipe_gw_common.yaml

cooking:
    datapoints:
        - procedure: translate_header
          ingredients:
              - fao_food-datapoints
          options:
              dictionary:
                  year: time
                  forest_share_in_land_area_ele1: forest_coverage_percent
                  forest_area_ile: forest_land_total_area_ha
                  planted_forest_area_ile: planted_forest_area_ha
                  primary_forest_area_ile: primary_forest_area_ha
                  sugar_sweeteners_food_supply_quantity_g_capita_day_fce: sugar_per_person_g_per_day
                  grand_total_food_supply_kcal_capita_day_fea: food_supply_kilocalories_per_person_and_day
          result: fao_food-datapoints-translated
        - procedure: translate_column
          ingredients:
              - fao_food-countries
          options:
              dictionary:
                  base: gw-countries
                  key: iso3166_1_alpha3
                  value: country
              column: iso3_code
              target_column: geo_new
          result: fao_food-countries-aligned
        - procedure: translate_column
          ingredients:
              - fao_food-datapoints-translated
          options:
              dictionary:
                  base: fao_food-countries-aligned
                  key: geo
                  value: geo_new
              column: geo
          result: fao_food-datapoints-final
