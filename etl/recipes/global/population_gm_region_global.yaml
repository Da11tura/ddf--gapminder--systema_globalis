info:
    id: rural-urban-population-global-year
    base: &gmpop open-numbers/ddf--gapminder--population


ingredients:
    - id: gmpop-region-datapoints
      dataset: *gmpop
      key: world_4region, year
      value:
          - population
    - id: gmpop-global-datapoints
      dataset: *gmpop
      key: global, year
      value:
          - population

cooking:
    datapoints:
        - procedure: translate_header
          ingredients:
              - gmpop-region-datapoints
          options:
              dictionary:
                  world_4region: geo
                  year: time
          result: gmpop-region-datapoints-translated
        - procedure: translate_header
          ingredients:
              - gmpop-global-datapoints
          options:
              dictionary:
                  global: geo
                  year: time
          result: gmpop-global-datapoints-translated

        - procedure: merge
          ingredients:
              - gmpop-global-datapoints-translated
              - gmpop-region-datapoints-translated
          options:
              deep: true
              debug: true
          result: gmpop-global-region-datapoints-final
